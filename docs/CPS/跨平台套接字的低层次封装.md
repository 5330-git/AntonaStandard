## 设计理念

- `CPS` 模块负责跨平台系统库的低水平封装，为其它较高层次的库组件提供服务
- 本文档介绍的是套接字的跨平台封装：
  - 介于Windows 套接字相对于 Linux 套接字额外有一个启动套接字库的操作，为了保证套接字库能够正确加载和释放，我定义了一个类`SocketLibaryManager` ，利用`RAII` 理念来管理套接字库的加载与释放，所有于套接字相关的函数都为它的成员函数这些成员函数是对更底层的系统调用的封装，这样可以保证调用这些系统函数前`SocketLibraryManager` 一定被实例化



### IO多路复用

#### select



#### poll



#### epoll





### 端口复用

参考 [TCP状态转换 | 爱编程的大丙 (subingwen.cn)](https://subingwen.cn/linux/tcp-status/) 

- 在网络通信中，一个端口只能被一个进程使用，不能多个进程共用同一个端口。我们在进行套接字通信的时候，如果按顺序执行如下操作：**先启动服务器程序，再启动客户端程序，然后关闭服务器进程，再退出客户端进程，最后再启动服务器进程**，就会出如下的错误提示信息：`bind error: Address already in use`

  - 通过 `netstat` 查看TCP状态，发现上一个服务器进程其实还没有真正退出。因为服务器进程是主动断开连接的进程, 最后状态变成了 `TIME_WAIT` 状态，这个进程会等待2 MSL(大约1分钟)才会退出，如果该进程不退出，其绑定的端口就不会释放，再次启动新的进程还是使用这个未释放的端口，端口被重复使用，就是提示`bind error: Address already in use`这个错误信息。


    

